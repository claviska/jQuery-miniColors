/*
 * jQuery miniColors: A small color selector
 *
 * Copyright 2011 Cory LaViska for A Beautiful Site, LLC. (http://abeautifulsite.net/)
 *
 * Dual licensed under the MIT or GPL Version 2 licenses
 *
*/(function(e){e.miniColors=function(t){var n=this,r=function(t){var n=e('<div style="display: none;" class="miniColors-selector"></div>');return n.append('<div class="miniColors-colors" style="background-color: #FFF;"><div class="miniColors-colorPicker"><div class="miniColors-colorPicker-inner"></div></div></div>').append('<div class="miniColors-hues"><div class="miniColors-huePicker"></div></div>'),n.find(".miniColors-colors").css("backgroundColor","#"+m({h:t.h,s:100,b:100})),f(n,t),n.bind("selectstart",function(){return!1}),n.data("hsb",t),n},i=function(e,t){},s=function(t){var n=!1,r;e(document).bind("mousedown.miniColors touchstart.miniColors",function(i){n=!0;var s=e(i.target).parents().andSelf();s.hasClass("miniColors-colors")&&(i.preventDefault(),r="colors",u(t,i)),s.hasClass("miniColors-hues")&&(i.preventDefault(),r="hues",a(t,i));if(s.hasClass("miniColors-selector")){i.preventDefault();return}if(s.hasClass("miniColors"))return;t.trigger("clickOutsideBounds")}),e(document).bind("mouseup.miniColors touchend.miniColors",function(e){e.preventDefault(),n=!1,r=undefined}).bind("mousemove.miniColors touchmove.miniColors",function(e){e.preventDefault(),n&&(r==="colors"&&u(t,e),r==="hues"&&a(t,e))})},o=function(){e(document).unbind(".miniColors")},u=function(e,t){var n={x:t.pageX,y:t.pageY},r=e.find(".miniColors-colors").offset();t.originalEvent.changedTouches&&(n.x=t.originalEvent.changedTouches[0].pageX,n.y=t.originalEvent.changedTouches[0].pageY),n.x=n.x-r.left-5,n.y=n.y-r.top-5,n.x<=-5&&(n.x=-5),n.x>=144&&(n.x=144),n.y<=-5&&(n.y=-5),n.y>=144&&(n.y=144);var i=Math.round((n.x+5)*.67);i<0&&(i=0),i>100&&(i=100);var s=100-Math.round((n.y+5)*.67);s<0&&(s=0),s>100&&(s=100);var o=e.data("hsb");o.s=i,o.b=s,l(e,o,!0)},a=function(e,t){var n={y:t.pageY},r=e.find(".miniColors-colors").offset();t.originalEvent.changedTouches&&(n.y=t.originalEvent.changedTouches[0].pageY),n.y=n.y-r.top-1,n.y<=-1&&(n.y=-1),n.y>=149&&(n.y=149);var i=Math.round((150-n.y-1)*2.4);i<0&&(i=0),i>360&&(i=360);var s=e.data("hsb");s.h=i,l(e,s,!0)},f=function(e,t){var n=c(t),r=e.find(".miniColors-colorPicker");r.css("top",n.y+"px").css("left",n.x+"px").show();var i=p(t),s=e.find(".miniColors-huePicker");s.css("top",i.y+"px").show()},l=function(e,t,n){f(e,t),e.data("hsb",t);var r=m(t);n&&e.trigger("updateInput",{hex:r}),e.find(".miniColors-colors").css("backgroundColor","#"+m({h:t.h,s:100,b:100})),e.trigger("setColor",{hex:r})},c=function(e){var t=Math.ceil(e.s/.67);t<0&&(t=0),t>150&&(t=150);var n=150-Math.ceil(e.b/.67);return n<0&&(n=0),n>150&&(n=150),{x:t-5,y:n-5}},p=function(e){var t=150-e.h/2.4;return t<0&&(h=0),t>150&&(h=150),{y:t-1}},d=function(e){var t={},n=Math.round(e.h),r=Math.round(e.s*255/100),i=Math.round(e.b*255/100);if(r===0)t.r=t.g=t.b=i;else{var s=i,o=(255-r)*i/255,u=(s-o)*(n%60)/60;n===360&&(n=0),n<60?(t.r=s,t.b=o,t.g=o+u):n<120?(t.g=s,t.b=o,t.r=s-u):n<180?(t.g=s,t.r=o,t.b=o+u):n<240?(t.b=s,t.r=o,t.g=s-u):n<300?(t.b=s,t.g=o,t.r=o+u):n<360?(t.r=s,t.g=o,t.b=s-u):(t.r=0,t.g=0,t.b=0)}return{r:Math.round(t.r),g:Math.round(t.g),b:Math.round(t.b)}},v=function(e){var t=[e.r.toString(16),e.g.toString(16),e.b.toString(16)],n,r=t.length,i;for(n=0;n<r;n++)i=t[n],i.length===1&&(t[n]="0"+i);return t.join("")},m=function(e){return v(d(e))};return n.setSelectorColor=l,n.buildSelector=r,n.bindSelectorEvents=s,n.unBindSelectorEvents=o,n}})(jQuery),jQuery&&jQuery.miniColors&&function(e){e.extend(e.fn,{miniColors:function(t,n){var r=new e.miniColors,i=function(t,n,r){var i=d(t.val());i||(i="ffffff");var s=g(i),o=e('<a class="miniColors-trigger" style="background-color: #'+i+'" href="#"></a>');o.insertAfter(t),t.addClass("miniColors").data("original-maxlength",t.attr("maxlength")||null).data("original-autocomplete",t.attr("autocomplete")||null).data("letterCase","uppercase").data("trigger",o).data("hsb",s).data("change",n.change?n.change:null).data("hide",n.hide?n.hide:null).attr("maxlength",7).attr("autocomplete","off").val("#"+h(i,n.letterCase)),n.readonly&&t.prop("readonly",!0),n.disabled&&u(t),o.bind("click.miniColors",function(e){e.preventDefault(),t.val()===""&&t.val("#"),a(t)}),t.bind("focus.miniColors",function(e){t.val()===""&&t.val("#"),a(t)}),t.bind("blur.miniColors",function(e){var n=d(t.val());t.val(n?"#"+h(n,t.data("letterCase")):"")}),t.bind("keydown.miniColors",function(e){e.keyCode===9&&f(t)}),t.bind("keyup.miniColors",function(e){c(t)}),t.bind("paste.miniColors",function(e){setTimeout(function(){c(t)},5)})},s=function(t){f(),t=e(t),t.data("trigger").remove(),t.attr("autocomplete",t.data("original-autocomplete")).attr("maxlength",t.data("original-maxlength")).removeData().removeClass("miniColors").unbind(".miniColors"),e(document).unbind(".miniColors")},o=function(e){e.prop("disabled",!1).data("trigger").css("opacity",1)},u=function(e){f(e),e.prop("disabled",!0).data("trigger").css("opacity",.5)},a=function(t){if(t.prop("disabled"))return!1;f();var n=r.buildSelector(t.data("hsb"));n.css({top:t.is(":visible")?t.offset().top+t.outerHeight():t.data("trigger").offset().top+t.data("trigger").outerHeight(),left:t.is(":visible")?t.offset().left:t.data("trigger").offset().left}).addClass(t.attr("class")),t.data("selector",n),e("BODY").append(n),n.fadeIn(100),r.bindSelectorEvents(n),n.bind("updateInput",function(e,n){t.val("#"+h(n.hex,t.data("letterCase")))}).bind("setColor",function(e,n){l(t,n.hex)}).bind("clickOutsideBounds",function(e){f(t)})},f=function(t){t||(t=".miniColors"),e(t).each(function(){var n=e(this).data("selector");n&&(n.unbind(),e(this).removeData("selector"),e(n).fadeOut(100,function(){t.data("hide")&&t.data("hide").call(t.get(0)),e(this).remove()}))}),r.unBindSelectorEvents()},l=function(e,t){var n=g(t),r=m(t);e.data("hsb",n).data("trigger").css("backgroundColor","#"+t);if(e.data("change")){if(t===e.data("lastChange"))return;e.data("change").call(e.get(0),"#"+t,r),e.data("lastChange",t)}},c=function(e){e.val("#"+p(e.val()));var t=d(e.val());if(!t)return!1;var n=g(t),i=e.data("hsb");if(n.h===i.h&&n.s===i.s&&n.b===i.b)return!0;var s=e.data("selector");return s&&r.setSelectorColor(s,n),l(e,t),!0},h=function(e,t){return t==="lowercase"?e.toLowerCase():t==="uppercase"?e.toUpperCase():e},p=function(e){return e.replace(/[^A-F0-9]/ig,"")},d=function(e){return e=p(e),e?(e.length===3&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]),e.length===6?e:null):null},v=function(e){var t={h:0,s:0,b:0},n=Math.min(e.r,e.g,e.b),r=Math.max(e.r,e.g,e.b),i=r-n;return t.b=r,t.s=r!==0?255*i/r:0,t.s!==0?e.r===r?t.h=(e.g-e.b)/i:e.g===r?t.h=2+(e.b-e.r)/i:t.h=4+(e.r-e.g)/i:t.h=-1,t.h*=60,t.h<0&&(t.h+=360),t.s*=100/255,t.b*=100/255,t},m=function(e){return e=parseInt(e.indexOf("#")>-1?e.substring(1):e,16),{r:e>>16,g:(e&65280)>>8,b:e&255}},g=function(e){var t=v(m(e));return t.s===0&&(t.h=360),t};switch(t){case"readonly":return e(this).each(function(){if(!e(this).hasClass("miniColors"))return;e(this).prop("readonly",n)}),e(this);case"disabled":return e(this).each(function(){if(!e(this).hasClass("miniColors"))return;n?u(e(this)):o(e(this))}),e(this);case"value":if(n===undefined){if(!e(this).hasClass("miniColors"))return;var y=e(this),b=d(y.val());return b?"#"+h(b,y.data("letterCase")):null}return e(this).each(function(){if(!e(this).hasClass("miniColors"))return;e(this).val(n),c(e(this))}),e(this);case"destroy":return e(this).each(function(){if(!e(this).hasClass("miniColors"))return;s(e(this))}),e(this);default:return t||(t={}),e(this).each(function(){if(e(this)[0].tagName.toLowerCase()!=="input")return;if(e(this).data("trigger"))return;i(e(this),t,n)}),e(this)}}})}(jQuery);